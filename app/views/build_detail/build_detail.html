<div id="build-detail" class="build-detail df_frame" confull-height style="">
    <div class="loader" ng-show="!databuild">
        <div class="loader-inner ball-clip-rotate-multiple">
            <div></div>
            <div></div>
        </div>
    </div>
    <div ng-show="databuild">
        <div class="panel panel-default panel_marginBottom" style="">
            <!-- module common 公共-->
            <div class="module-heading">
                <div class="module_block_l">
                    <div class="img-block">
                            <svg class="icon svg_img" viewBox="0 0 64 64"><path d="M32.07,0a32,32,0,1,0,32,32A32,32,0,0,0,32.07,0Zm-10,39.17A2.28,2.28,0,0,1,22,42.41a2.25,2.25,0,0,1-1.71.71,2.35,2.35,0,0,1-1.71-.71s-9.81-9.52-9.66-9.52A2.35,2.35,0,0,1,8.18,31,2.48,2.48,0,0,1,9,29.33l9.81-8.1A2.42,2.42,0,1,1,22,24.93l-7.67,6.54ZM39.16,24.36,29.21,42a2.64,2.64,0,0,1-2.13,1.28A2.68,2.68,0,0,1,25.95,43a2.36,2.36,0,0,1-.85-3.27L35,22.09a2.36,2.36,0,0,1,3.27-.85A2.14,2.14,0,0,1,39.16,24.36Zm6.25,18.19a3,3,0,0,1-1.71.71A2.35,2.35,0,0,1,42,42.55a2.59,2.59,0,0,1,0-3.41l7.82-7.67-7.67-6.54a2.42,2.42,0,0,1,3.13-3.7l9.81,8.1A2,2,0,0,1,55.93,31a2,2,0,0,1-.71,2Z"/></svg>
                    </div>
                    <div class="img-detail">
                        <p class="img-tit">{{data.metadata.name}}</p>
                        <p class="img-time">
                            <span classs="module_tit">创建时间：</span><span class="module_time">{{data.metadata.creationTimestamp | timescon}}</span>
                        </p>
                        <p class="img-new"  ng-show="canjump">
                            <span class="module_tit">代码URL：</span><a class="href-orange text-overflow href-orange_a" href="{{myurl}}" target="_blank" style="">{{myurl}}</a><span ng-show="myref" class="module_tit" style="margin-left: 40px;">分支/tag：{{myref}}</span>

                        </p>
                        <p class="img-new"  ng-show="!canjump">
                            <span class="module_tit">代码URL：{{myurl}}</span><span ng-show="myref" class="module_tit" style="margin-left: 40px;">分支/tag：{{myref}}</span>
                        </p>
                    </div>
                    <div class="media media-sm" ng-if="imageEnable">
                        <span class="module_tit">镜像</span>
                        <a class="href-orange" ui-sref="console.image_detail({name: data.spec.output.to.name, bc: data.metadata.name})">{{data.spec.output.to.name}}</a>
                    </div>

                </div>
                <div class="module_block_r">
                    <a class="btn btn-gray pull-right btn_a df_del" style="" ng-click="deletes()">
                        <!-- <i class="fa fa-trash-o fa-lg"></i> -->
                        <span class="df_close"><i class="uex-icon-delete"></i></span>
                    </a>
                    <a class="btn btn-green pull-right df_build" ng-click="startBuild()"> 重新构建</a>
                </div>
            </div>
            <!-- module common 公共-->
        </div>

        <uib-tabset class="tab-default tab-jia-default" active="active">
            <uib-tab index="1">
                <uib-tab-heading>
                    <!-- <span class="icon20 icon20-log"></span>  -->
                    构建记录
                </uib-tab-heading>
                <div class="timeline">
                    <ul>
                        <li ng-repeat="item in databuild.items">

                            <span class="dot"></span>&nbsp;&nbsp;&nbsp;&nbsp;
                            <span class="dot_blank"></span>
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-sm-2">
                                        <span class="detail_tit">构建状态：</span>
                                        <span class="icon12 uex-icon-{{item.status.phase}}" ng-class="{'fa-spin': item.status.phase == 'Running' || item.status.phase == 'Pending'}"></span>
                                        <!--switch to Chinese-->
                                        <span class="build_name">{{item.status.phase | phaseFilter}}</span>
                                    </div>

                                    <div class="col-sm-3">
                                        <span class="detail_tit">构建时间：</span>
                                        <label class="build_name">
                                            {{item.metadata.creationTimestamp | timescon}}
                                        </label>
                                    </div>

                                    <div class="col-sm-2">
                                        <span class="detail_tit">构建时长：</span>
                                        <label class="build_name">
                                            {{item.status.duration | duration}}
                                        </label>
                                    </div>

                                    <div class="col-sm-3">
                                        <span class="detail_tit">版本：</span>
                                        <label class="build_name" uib-tooltip="{{data.metadata.name}}:{{item.spec.revision.git.commit | limitTo: 7}}">
                                            {{data.metadata.name}}:{{item.spec.revision.git.commit | limitTo: 7}}
                                        </label>
                                    </div>



                                    <div class="col-sm-2 text-right">
                                        <a ng-if="item.status.phase == 'Complete'" ui-sref="console.image_detail({namespace:namespace,bc: item.metadata.labels.buildconfig, name: item.spec.output.to.name})"
                                            class="icon25" uib-tooltip="查看镜像">
                                            <svg viewBox="0 0 64 64" style="width:18px;height:18px;fill:#57B5F2;margin-top:-10px;"><path d="M26.49,15.76l.1,0-16.13-5a2.77,2.77,0,0,0-.56-.05,2.7,2.7,0,0,0-2.7,2.7V52a2.7,2.7,0,0,0,2.7,2.71,3.36,3.36,0,0,0,.56-.05L27,49.5a3.37,3.37,0,0,0,1.83-3V19A3.39,3.39,0,0,0,26.49,15.76ZM24.77,45.32l-13.51,3.6V16.49l13.51,3.6ZM53.14,10.69a3.36,3.36,0,0,0-.56.05l-15.94,5h.05A3.38,3.38,0,0,0,34.21,19V46.49a3.38,3.38,0,0,0,1.83,3l16.52,5.16a2.83,2.83,0,0,0,.57.05A2.7,2.7,0,0,0,55.83,52V13.4a2.69,2.69,0,0,0-2.69-2.7Z"/></svg>
                                        </a>
                                       
                                        <a ng-if="item.status.phase == 'Pending' || item.status.phase == 'Running' || item.status.phase == 'New'" ng-click="stop($index)"
                                            class="icon25 uex-icon-stop-all" uib-tooltip="终止" href="javascript:;"></a>
                                        <a class="icon25 uex-icon-view" uib-tooltip="查看内容" ng-click="getLog($index,item)" href="javascript:;"></a>
                                        <a ng-if="item.status.phase !== 'Pending' && item.status.phase !== 'Running' && item.status.phase !== 'New'" ng-click="delete($index)"
                                        class="icon25 uex-icon-delete" uib-tooltip="删除" href="javascript:;"></a>
                                    </div>
                                </div>
                            </div>
                            <div uib-collapse="!item.showLog">
                                <div class="well well-log well-log_overflow" style=''>
                                    <pre class="sa_color" style="height: 300px;" id='sa' ng-bind-html=item.buildLog></pre>
                                </div>
                            </div>
                        </li>
                        <div  style="" class="ng-scope border_background" ng-if="databuild.items.length===0">
                            <span class="dot"></span>
                            <span class="dot_blank"></span>
                            <p class="blank_name">
                                <span class="blank_tit">您还没有构建记录</span>
                            </p>
                        </div>
                    </ul>
                </div>
                <!--<c-timeline name="bcName" type="build"></c-timeline>-->
            </uib-tab>
            <uib-tab index="2">
                <uib-tab-heading>
                    <!-- <span class="icon20 icon20-paper"></span>  -->
                    配置信息
                </uib-tab-heading>
                <form class="form-horizontal" name="frm">
                    <div ng-show="!showwebhook">

                        <div>
                            <div>
                                <div class="pip_block">
                                    <p class="pit_left">Generic Webhook URL:</p>
                                    <span class="pip_tit">
                                       {{httpurl}}/oapi/v1/namespaces/{{buildnamespaces}}/buildconfigs/{{data.metadata.name}}/webhooks/{{data.spec.triggers[1].generic?data.spec.triggers[1].generic.secret:data.spec.triggers[0].generic.secret}}/generic
                                    </span>
                                    <i class="pip_btn uex-icon-copy" uib-tooltip="复制" ng-class="{'iscopyactive':isCopy}" ng-click="gcopy($event)"></i>
                                </div>

                            </div>

                            <div>
                                <div class="pip_block">
                                    <p class="pit_left">GitHub Webhook URL:</p>
                                    <span class="pip_tit">
                                        {{httpurl}}/oapi/v1/namespaces/{{buildnamespaces}}/buildconfigs/{{data.metadata.name}}/webhooks/{{data.spec.triggers[0].github?data.spec.triggers[0].github.secret:data.spec.triggers[1].github.secret}}/github
                                    </span>
                                    <i class="pip_btn uex-icon-copy" uib-tooltip="复制" ng-class="{'iscopyactive':isCopy}" ng-click="gcopy($event)"></i>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="form-group" ng-show="showwebhook">
                        <!--<label class="col-sm-2 text-left" id="autobuild">自动构建触发条件</label>-->
                        <label class="col-sm-2 text-left">自动构建</label>
                        <div class="col-sm-2">
                            <!--<c-checkbox checked="grid.checked"></c-checkbox>-->
                            <!--ng-class="{'aciive': grid.checked, 'inactive': gird.uncheked}"-->
                            <span class="my-checkbox">
                                <span class="checkbox-check" ng-class="{active: grid.checked}" ng-click="saveTrigger(grid.checked)">
                                    <span class="check-btn"></span>
                                </span>
                                <!--<span ng-if="text" class="checkbox-text">{{text}}</span>-->
                            </span>
                        </div>

                    </div>
                    <!--<div class="form-group" ng-show="!showwebhook||grid.pedding">-->
                        <!--&lt;!&ndash;<label class="col-sm-2 text-left" id="autobuild">自动构建触发条件</label>&ndash;&gt;-->
                        <!--<label class="col-sm-3 text-left text-left_color" style="">自动构建</label>-->
                        <!--<div class="col-sm-2">-->
                            <!--<span class="my-checkbox">-->
                                <!--<span class="checkbox-check">-->
                                    <!--<span class="check-btn"></span>-->
                                <!--</span>-->

                            <!--</span>-->
                            <!--&lt;!&ndash;ng-class="{'aciive': grid.checked, 'inactive': gird.uncheked}"&ndash;&gt;-->
                        <!--</div>-->

                    <!--</div>-->

                    <div class="form-group form-group_padding" style="" ng-if="false">
                        <label class="col-sm-3 text-left">是否持续集成</label>
                        <div class="col-sm-2">
                            <c-checkbox checked="checked"></c-checkbox>
                        </div>
                        <div class="col-sm-7" ng-if="checked">
                            <small class="small_margin" style="">点击按钮，进行持续集成配置</small>
                            <a class="btn btn-orange">持续集成配置</a>
                        </div>
                    </div>

                    <div class="form-group form-group_paddingTop" style="display:none;">
                        <label class="col-sm-3 text-left">构建超时时长</label>
                        <div class="col-sm-9">
                            <input class="input_sty" ng-model="grid.completionDeadlineMinutes" name="cdm" min="1" max="60" ng-disabled="!deadlineMinutesEnable"
                                style="" type="number" class="form-control">
                            <span class="form_group_span" style="">&nbsp;mins&nbsp;</span>
                            <a href="javascript:;" class="form_group_a" style="" ng-click="frm.cdm.$valid && save()">
                                <span class="fa fa-orange" ng-class="{'fa-pencil': !deadlineMinutesEnable, 'fa-check-circle': deadlineMinutesEnable}"></span>
                            </a>
                            <span class="font12">&nbsp;&nbsp;构建超时时长请不要超过60Mins</span>
                            <br>
                            <small ng-if="frm.cdm.$invalid" class="fa fa-exclamation-circle fa_small" style="">&nbsp;您设置的时长超过了限制，请重新设置</small>
                        </div>
                    </div>
                </form>
            </uib-tab>
        </uib-tabset>
    </div>
</div>