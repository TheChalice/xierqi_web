'use strict';angular.module('console.create_routes', [{    files: [        'views/apps/create_routes/create_routes.css'    ]}])    .controller('CreateRoutesCtrl', ['$scope','Service','Route','$stateParams','createRoutes',        function($scope,Service,Route, $stateParams,createRoutes) {            //获取service列表                if($stateParams.name){                    $scope.routeName = $stateParams.name;                    $scope.routeDetail = createRoutes;                    console.log('$scope.routeDetail',$scope.routeDetail);                }else{                    $scope.routeDetail = {                        apiVersion:'v1',                        metadata:{                            labels:{},                            name:"",                        },                        spec:{                            host:"",                            path:"",                            tls:{                                termination:"",                                insecureEdgeTerminationPolicy: "Allow"                            },                            to:{                                kind:'Service',                                name:"",                                weight:""                            },                            wildcardPolicy:"None"                        },                    }                }               Service.get({ namespace: $scope.namespace }, function(res) {                   console.log('res111', res);                   $scope.serviceList = res.items;               });                $scope.tlsList = ["Edge","Passthrough","Re-encrypt"];                $scope.insecureList = ["None","Allow","Redirect"];                $scope.tlsListValue = 'Edge';                $scope.insecureListvalue = 'None'                $scope.securityType = false ;                $scope.alternateType = false;                $scope.checkSl = function(idx){                }                $scope.testserviceList = [];               $scope.labelList = [];               $scope.CertificateObjs = {                   'Certificate':{                       'typeTitle':'Certificate',typeObjs:{key:'', value: ''}                   },                   'PrivateKey':{                       typeTitle:'Private Key',typeObjs:{key:'', value: ''}                   },                   'CACertificate':{                       typeTitle:'CA Certificate',typeObjs:{key:'', value: ''}                   },                   'Destination':{                       typeTitle:'Destination CA Certificate',typeObjs:{key:'', value: ''}                   },               }               function readSingleFile(e,_this,type) {                   var thisfilename = _this.value;                   if (thisfilename.indexOf('\\')) {                       var arr = thisfilename.split('\\');                       thisfilename = arr[arr.length - 1]                   }                   var file = e.target.files[0];                   console.log('file', file);                   if (!file) {                       return;                   }                   var reader = new FileReader();                   reader.onload = function (e) {                       var content = e.target.result;                       if(type == 'Certificate'){                           $scope.CertificateObjs.Certificate.typeObjs = {key: thisfilename, value: content};                       }else if(type == 'PrivateKey'){                           $scope.CertificateObjs.PrivateKey.typeObjs = {key: thisfilename, value: content};                       }else if(type == 'CACertificate'){                           $scope.CertificateObjs.CACertificate.typeObjs = {key: thisfilename, value: content};                       }else if(type == 'Destination'){                           $scope.CertificateObjs.Destination.typeObjs = {key: thisfilename, value: content};                       }                       $scope.$apply();                   };                   reader.readAsText(file);               };               //删除label;               $scope.rmLabel = function(idx){                   $scope.labelList.splice(idx, 1);               }               //添加label;               $scope.addLabel = function(){                   $scope.labelList.push({name:'',value:''});               }               //创建Routes               $scope.createRoutes = function(){               }                $scope.addCertificate = function (type) {                   var _this = document.getElementById(type);                    _this.addEventListener('change', function(event){readSingleFile(event,_this,type)}, false);                }                $scope.changeSecurity = function(){                        if($scope.securityType){                            $scope.securityType = false;                            delete $scope.routeDetail.spec.alternateBackends;                        }else{                            $scope.securityType = true;                            $scope.routeDetail.spec.alternateBackends = [{}]                        }                }                $scope.changeAlternate = function(){                    if($scope.alternateType){                        $scope.alternateType = false;                        delete $scope.routeDetail.spec.tls;                    }else{                        $scope.alternateType = true;                        $scope.routeDetail.spec.tls = {};                    }                }                $scope.changetls = function(val){                    $scope.tlsListValue = val;                }                $scope.changeinsecure = function(val){                    $scope.insecureListvalue = val                }                $scope.removeService = function(){                }                $scope.addService = function(){                }        }    ]);